require("Runtime.Common.Base.class")
local x3Random = require("PureLogic.Common.Misc.X3Random")

function TestX3RandomNext()
    local tests = {
        {
            name = "zero_n",
            seed = 0,
            expects = { 1559595546 }
        },
    }

    for _, test in ipairs(tests) do
        print("=== Run TestX3RandomNext: " .. test.name)
        local x3Ran = x3Random.new(test.seed)
        for i, expect in ipairs(test.expects) do
            local r = x3Ran:Next()
            if r ~= expect then
                print("--- Fail TestX3RandomNext: name:" .. test.name .. ", index:" .. i .. ", got:" .. r .. ", want:" .. expect)
            end
        end
    end
end

function TestX3RandomNextN()
    local tests = {
        {
            name = "zero_n",
            seed = 544187415, n = 0,
            expects = { 0 }
        },
        {
            name = "success",
            seed = 544187415, n = 2147483645,
            expects = { 2116109624, 1796442096, 906373155, 436968097, 1800355195, 2043643656, 2018886221, 1623170231,
                        790721790, 1885587145, 1812399581, 521395365, 620567313, 1262457136, 349226773, 424753032, 1321212786, 186266916,
                        530157916, 741123698, 1163160870, 199777758, 1502027741, 94682468, 1226427797, 778870645, 184287518, 1263725589,
                        1781864891, 1919729165, 179600601, 157631896, 224507258, 1689871164, 379853062, 5291271, 1441195933, 960817493,
                        2129413159, 1132494471, 1365741275, 1560629990, 105194212, 649799629, 1397377566, 537828209, 1795446699, 596511989,
                        511010729, 1297669953, 1339497209, 1731625740, 944431471, 218651959, 1986883209, 1916331866, 294414355, 811690687,
                        1358023947, 1021484550, 1859356138, 755160632, 1988788987, 1018476272, 1705986544, 1654767685, 296888107, 1078179796,
                        882604074, 343935502, 1131040746, 360395293, 204337404, 1545147092, 1522866070, 1750014527, 94583546, 852228112, 844788549,
                        688599588, 1130907593, 1735259176, 752714860, 484194938, 580231956, 595458508, 1360684072, 5855299, 1850471602, 611004843,
                        1858360563, 629505246, 1750277193, 1107928609, 1420621980, 610580643, 1719324650, 1234201587, 1091296732, 1890093528 }
        },
    }

    for _, test in ipairs(tests) do
        print("=== Run TestX3RandomNextN: " .. test.name)
        local x3Ran = x3Random.new(test.seed)
        for i, expect in ipairs(test.expects) do
            local r = x3Ran:NextN(test.n)
            if r ~= expect then
                print("--- Fail TestX3RandomNextN: name:" .. test.name .. ", index:" .. i .. ", got:" .. r .. ", want:" .. expect)
            end
        end
    end
end

function TestX3RandomNextRange()
    local tests = {
        {
            name = "illegal_min_max",
            seed = 544187415, min = 100, max = 100,
            expects = { 100 }
        },
        {
            name = "success",
            seed = 544187415, min = 345142341, max = 2147483645,
            expects = { 2141584437, 1251515496, 782110438, 2145497536, 1968312572, 1135864131, 866537706, 965709654, 1607599477,
                        694369114, 769895373, 1666355127, 531409257, 875300257, 1086266039, 1508303211, 544920099, 1847170082, 439824809, 1571570138,
                        1124012986, 529429859, 1608867930, 2127007232, 524742942, 502774237, 569649599, 2035013505, 724995403, 350433612, 1786338274,
                        1305959834, 1477636812, 1710883616, 1905772331, 450336553, 994941970, 1742519907, 882970550, 2140589040, 941654330, 856153070,
                        1642812294, 1684639550, 2076768081, 1289573812, 563794300, 639556696, 1156833028, 1703166288, 1366626891, 1100302973, 1363618613,
                        2051128885, 1999910026, 642030448, 1423322137, 1227746415, 689077843, 1476183087, 705537634, 549479745, 1890289433, 1868008411,
                        2095156868, 439725887, 1197370453, 1189930890, 1033741929, 1476049934, 2080401517, 1097857201, 829337279, 925374297, 940600849,
                        1705826413, 350997640, 956147184, 974647587, 2095419534, 1453070950, 1765764321, 955722984, 2064466991, 1579343928, 1436439073,
                        586082443, 1062409244, 512217568, 511771548, 1324244257, 1872430677, 1891910367, 1188411877, 582011023, 1934812231, 1014566700,
                        469239303, 347588113, 1849736390 }
        },
    }

    for _, test in ipairs(tests) do
        print("=== Run TestX3RandomNextRange: " .. test.name)
        local x3Ran = x3Random.new(test.seed)
        for i, expect in ipairs(test.expects) do
            local r = x3Ran:NextRange(test.min, test.max)
            if r ~= expect then
                print("--- Fail TestX3RandomNextRange: name:" .. test.name .. ", index:" .. i .. ", got:" .. r .. ", want:" .. expect)
            end
        end
    end
end

function runTest()
    TestX3RandomNext()
    TestX3RandomNextN()
    TestX3RandomNextRange()
end

runTest()

