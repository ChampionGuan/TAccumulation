---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by canglan.
--- DateTime: 2021/11/18 11:04
---

local SlotBase = require("Runtime.Battle.Behavior.UI.Slot.SlotBase")

---@class ActiveSlot:SlotBase
local ActiveSlot = XECS.class("ActiveSlot", SlotBase)
ActiveSlot.Type = BattleSlotBehaviorType.ActiveSlot

local PlayerBtnType = CS.X3Battle.PlayerBtnType

function ActiveSlot:ctor()
    SlotBase.ctor(self)
    self._curFrame = 1

    self._cdIndex = 0
    self._disableIndex = 1
    self._egIndex = 2
    self._activeIndex = 3
end

function ActiveSlot:Awake()
    SlotBase.Awake(self)
    self._transform = self:GetComponent("OCX_PositiveSkill", "Transform")
    self._headImgTrans = self:GetComponent("OCX_Positive_img_head", "Transform")
    self._cdImgTrans = self:GetComponent("OCX_Positive_img_mask", "Transform")
    self._cdText = self:GetComponent("OCX_Positive_text_cd", "TextMeshProUGUI")
    self._effect = self:GetComponent("OCX_Positive_fx_ui_battle_click", "ParticleSystem")
    self._longPressOutEffect = self:GetComponent("OCX_Positive_fx_ui_battle_click_out", "ParticleSystem")
    self._longLoopEffect = self:GetComponent("OCX_Positive_fx_ui_battle_click_loop", "ParticleSystem")
    self._emergeEffect = self:GetComponent("OCX_Positive_fx_ui_battle_emerge", "ParticleSystem")
    self._styleEnum = self._transform:GetComponent("StyleEnum")
    self._costEgNumText = self:GetComponent("OCX_Positive_EgNum", "TextMeshProUGUI")

    self._gridBgTrans = self:GetComponent("OCX_Positive_number", "Transform")
    self._gridTrans = self:GetComponent("OCX_Positive_segment","Transform")
    self:SetActive(self._gridTrans,true)
    self:SetNodeVisible(self._gridTrans,false)
    self._cdGridTrans = self:GetComponent("OCX_Positive_prgs", "Transform")
    self:SetActive(self._gridBgTrans, true)

    self._btnType = PlayerBtnType.Active
    self:Register()
end

---@param state Int
function ActiveSlot:TryPlaySkill(state)
    if not self._slot then
        return
    end
    SlotBase.TryPlaySkill(self, state, false, self._slot:IsCD() or not self._slot:IsEnergyFull())
end


function ActiveSlot:OnDestroy()
    SlotBase.OnDestroy(self)
end

return ActiveSlot