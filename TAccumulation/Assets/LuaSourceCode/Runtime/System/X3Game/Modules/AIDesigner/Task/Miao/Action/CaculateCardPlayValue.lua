---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by baozhatou.
--- DateTime: 2023/2/9 20:45
---

---@type MiaoBaseAIAction
local BaseAIAction = require("PureLogic.AI.Task.Miao.MiaoBaseAIAction")
--- 计算卡牌的Play价值
---Category:Miao
---@class CaculateCardPlayValue:MiaoBaseAIAction
---@field playerSeat Miao.MiaoPlayerPos | Int 玩家类型
---@field target AIVar | Int 目标格子索引
---@field cardID AIVar | Int 预期出牌的cardID
---@field cardValue AIVar | Float 出牌价值
local CaculateCardPlayValue = class("CaculateCardPlayValue",BaseAIAction)

function CaculateCardPlayValue:OnEnter()
    if self.cardID == nil then
        LogicUtil.LogError("获取CardID失败，cardID为空 , " .. self.tree._config.name .. " , " ..self.tree._config.pathPrefix)
    end
    local cardID = self.cardID:GetValue()
    local slotIndex = self.target:GetValue()
    local calComp = self.entity:GetComponent(Miao.Component.Debug.PlayerCalculatorComp)
    local value = calComp:CalCardPlayValue(cardID,self.playerSeat,slotIndex)
    self.cardValue:SetValue(value)
end

function CaculateCardPlayValue:OnUpdate()
    return AITaskState.Success
end

return CaculateCardPlayValue