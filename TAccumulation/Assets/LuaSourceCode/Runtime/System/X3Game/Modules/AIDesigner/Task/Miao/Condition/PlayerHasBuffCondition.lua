---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by baozhatou.
--- DateTime: 2023/1/13 14:27
---

---@type MiaoBaseAICondition
local BaseCondition = require("PureLogic.AI.Task.Miao.MiaoBaseAICondition")

--- 玩家是否有buff
---Category:Miao
---@class PlayerHasBuffCondition : MiaoBaseAICondition
---@field playerSeat Miao.MiaoPlayerPos | Int
---@field buffID Miao.MiaoBuffType | Int Buff类型
---@field negate boolean 结果是否取反
local PlayerHasBuffCondition = class("PlayerHasBuffCondition",BaseCondition)

function PlayerHasBuffCondition:OnUpdate()
    local playerSeat = self.playerSeat--:GetValue()
    local bbComp = self.entity:GetComponent(Miao.Component.Debug.BlackboardComp)
    local player = bbComp:GetPlayer(playerSeat)
    local buffList = player.BuffList or {} --self.buffList:GetValue()
    local has = false
    for k,v in pairs(buffList) do
        if v == self.buffID then
            has = true
            break
        end
    end
    local result = AITaskState.Failure
    if has then
        result = self.negate and AITaskState.Failure or AITaskState.Success
    else
        result = self.negate and AITaskState.Success or AITaskState.Failure
    end

    return result
end

return PlayerHasBuffCondition