---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by baozhatou.
--- DateTime: 2023/6/5 19:16
---

---@type MiaoBaseAIAction
local BaseAIAction = require("PureLogic.AI.Task.Miao.MiaoBaseAIAction")
---计算男主最大得分出牌后的预期分数
---Category:Miao
---@class CalculatePlayCardExpectScore:MiaoBaseAIAction
---@field playerSeat Miao.MiaoPlayerPos | Int PlayerSeat
---@field onlyDoubleSlot AIVar | boolean 是否只计算双倍格子
---@field expectScore AIVar | Int 玩家出牌后的预期得分
---@field expectCardID AIVar | Int 预期出牌的cardID
---@field expectSlotIndex AIVar | Int 预期的出牌的格子索引
local CalculatePlayCardExpectScore = class("CalculatePlayCardExpectScore",BaseAIAction)

function CalculatePlayCardExpectScore:OnEnter()

    local bbComp = self.entity:GetComponent(Miao.Component.Debug.BlackboardComp)
    local seat = self.playerSeat
    if seat == Miao.MiaoPlayerPos.MiaoPlayerPosNope then
        seat = Miao.MiaoPlayerPos.MiaoPlayerPosP2
    end
    local player = bbComp:GetPlayer(seat)
    local maxScore,cardID,slotIndex = bbComp:CalMaxScoreByNumCards(player,self.onlyDoubleSlot:GetValue())

    self.expectScore:SetValue(maxScore)
    self.expectCardID:SetValue(cardID)
    self.expectSlotIndex:SetValue(slotIndex)
end

function CalculatePlayCardExpectScore:OnUpdate()
    return AITaskState.Success
end

return CalculatePlayCardExpectScore