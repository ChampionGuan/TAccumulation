---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by junjun003.
--- DateTime: 2021/12/16 11:44
---

local DialogueAction = require("Runtime.System.X3Game.Modules.AIDesigner.Task.Dialogue.Action.DialogueAction")

---Category:Dialogue
---@class DialogueResumeConversation:DialogueAction
---@field pipelineKey string|AIVar 可以给播放的Pipeline指定Key，用来定向暂停，继续，停止等操作
local DialogueResumeConversation = class("DialogueResumeConversation", DialogueAction)

function DialogueResumeConversation:OnEnter()
    self.super.OnEnter(self)
    ---共享数据防止Update时被改变，需要在OnEnter时记录本地值
    self._pipelineKey = self.pipelineKey:GetValue()
    Debug.LogFormat("[DialogueSystem]AI开始-%s-%s", self.tree:GetName(), self:_GetPath())
end

function DialogueResumeConversation:OnUpdate()
    if self.dialogueController ~= nil then
        Debug.LogFormat("[DialogueSystem]AI结束-%s-%s", self.tree:GetName(), self:_GetPath())
        self.dialogueController:ResumePipeline(self._pipelineKey)
        return AITaskState.Success
    else
        Debug.LogError("没有为AI注入DialogueController，请检查。")
        return AITaskState.Failure
    end
end

---
function DialogueResumeConversation:OnExit()
    Debug.LogFormat("[DialogueSystem]AI退出-%s-%s", self.tree:GetName(), self:_GetPath())
end

return DialogueResumeConversation