---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiaozhu.
--- DateTime: 2022/3/1 21:54
---
---@type MainHome.MainHomeConst
local MainHomeConst = require("Runtime.System.X3Game.Modules.MainHome.Data.MainHomeConst")
local AIAction = require("Runtime.System.X3Game.Modules.AIDesigner.Task.MainHome.Action.MainHomeBaseAIAction")
---检测action是否结束
---Category:MainHome
---@class MainHomeCheckActionEnd:MainHomeBaseAIAction
---@field actionId AIVar | int
---@field actionList AIArrayVar | int
---@field isPerformance boolean
local MainHomeCheckActionEnd = class("MainHomeCheckActionEnd",AIAction)

function MainHomeCheckActionEnd:OnAwake()
    AIAction.OnAwake(self)
    self.checkFunc = self.isPerformance and self.bll.IsActionShowRunning or self.bll.IsActionRunning
end

function MainHomeCheckActionEnd:OnUpdate()
    if self:IsActionRunning(self.actionId:GetValue()) then
        return AITaskState.Failure
    end
    for k,v in pairs(self.actionList:GetValue()) do
        if self:IsActionRunning(v:GetValue()) then
            return AITaskState.Failure
        end
    end
    return AITaskState.Success
end

function MainHomeCheckActionEnd:IsActionRunning(actionId)
    return self.checkFunc(self.bll,actionId)
end

return MainHomeCheckActionEnd