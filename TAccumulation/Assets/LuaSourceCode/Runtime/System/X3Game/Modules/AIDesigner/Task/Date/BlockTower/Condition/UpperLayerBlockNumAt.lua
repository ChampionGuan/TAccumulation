---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by junjun003.
--- DateTime: 2022/9/19 14:22
---

local AICondition = require("Runtime.Plugins.AIDesigner.Base.AITask").AICondition

---Category:Date/BlockTower
---当前【SafeBlockTowerList】组所在层的上一层块的数量
---@class IsBlockListNumAt:AICondition
---@field minCount int
---@field maxCount int
local UpperLayerBlockNumAt = class("UpperLayerBlockNumAt", AICondition)

---
function UpperLayerBlockNumAt:OnEnter()
    ---@type BlockTowerGameController
    self.gameController = self.tree:GetVariable("GameController")
    ---@type BlockTowerGameData
    self.gameData = self.gameController:GetGameData()
end

---@return AITaskState
function UpperLayerBlockNumAt:OnUpdate()
    if self.gameData.safeBlockList == nil or #self.gameData.safeBlockList <= 0 then
        return AITaskState.Failure
    end

    local upperLayerBlockList = self.gameData:GetPhysicsLayer(self.gameData.aiChoosedLayer + 1)
    if upperLayerBlockList and #upperLayerBlockList >= self.minCount and #upperLayerBlockList <= self.maxCount then
        return AITaskState.Success
    else
        return AITaskState.Failure
    end
end

return UpperLayerBlockNumAt