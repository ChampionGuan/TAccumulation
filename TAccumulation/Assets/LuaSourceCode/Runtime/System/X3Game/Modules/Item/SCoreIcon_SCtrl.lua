---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by canghai.
--- DateTime: 2022/8/31 10:23
---

---@type ItemSubCtrl
local ItemSubCtrl = require(ItemConst.ITEM_SUB_CTRL_PATH)

---@type SCoreIcon_SData
local SCoreIcon_SData = require(ItemConst.ITEM_SCORE_ICON_S_DATA_PATH)

---@class SCoreIcon_SCtrl:ItemSubCtrl
local SCoreIcon_SCtrl = class("SCoreIcon_SCtrl", ItemSubCtrl)
function SCoreIcon_SCtrl:Init()
    ---@type SCoreIcon_SData
    self.sCoreIcon_SData = nil
end

---@return ItemConst.ItemType
function SCoreIcon_SCtrl:GetItemType()
    return ItemConst.ItemType.SCORE_ICON_S
end

--- 修改 SCoreIcon_SData
---@param dataEnum ItemConst.DataEnum
---@param value any
function SCoreIcon_SCtrl:SetData(dataEnum, value)
    --TODO 在此拓展
end

function SCoreIcon_SCtrl:UpdateView()
    --保证每次取到的数据都是最新的
    ---@type ItemCtrl
    local owner = self.owner
    self.sCoreIcon_SData = owner.itemData.itemSubDataDic[ItemConst.ItemType.SCORE_ICON_S]

    ---@type SCoreIcon_SData
    local sCoreIcon_SData = self.sCoreIcon_SData
    if not sCoreIcon_SData.isDirty then
        return
    end

    self:_ShowIconAndBg()
    self:_ShowRarity()
    sCoreIcon_SData.isDirty = false
end

--region Private Field
---@private
function SCoreIcon_SCtrl:_ShowIconAndBg()
    self:SetActiveStatus(ItemConst.OCX_SCORE_ICON_S_IMG_ICON, true)
    self:SetActiveStatus(ItemConst.OCX_SCORE_ICON_S_IMG_BG, true)
    ---@type SCoreIcon_SData
    local sCoreIcon_SData = self.sCoreIcon_SData
    self:SetImage(ItemConst.OCX_SCORE_ICON_S_IMG_BG, sCoreIcon_SData.sCoreRareInfoConfig.ScoreBgSmall)
    local suitConfig = LuaCfgMgr.Get("FormationSuit", sCoreIcon_SData.suitId)
    if suitConfig then
        self:SetImage(ItemConst.OCX_SCORE_ICON_S_IMG_ICON, suitConfig.ActorSmallIcon)
    end
end

function SCoreIcon_SCtrl:_ShowRarity()
    self:SetActiveStatus(ItemConst.OCX_SCORE_ICON_S_IMG_RARITY_B, true)
    ---@type SCoreIcon_SData
    local sCoreIcon_SData = self.sCoreIcon_SData
    self:SetImage(ItemConst.OCX_SCORE_ICON_S_IMG_RARITY_B, sCoreIcon_SData.sCoreRareInfoConfig.ScoreBgFront)
end

function SCoreIcon_SCtrl:OnClose()
    self.sCoreIcon_SData = nil
    X3AssetInsProvider.ReleaseIns(self.gameObject)
end
--endregion

return SCoreIcon_SCtrl