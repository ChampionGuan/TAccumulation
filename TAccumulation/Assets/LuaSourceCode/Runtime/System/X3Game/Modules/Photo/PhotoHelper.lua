---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by liyan.
--- DateTime: 2022/12/5 11:05
---

---@class PhotoHelper
local PhotoHelper = {}

---返回自适应之后的相片尺寸
---@param srcWidth int 原图宽
---@param srcHeight int 原图宽
---@return int,int
function PhotoHelper.AutoResizePhoto(srcWidth, srcHeight)

    local srcRatio = srcWidth / srcHeight

    local canvasRect = GameObjectUtil.GetComponent(UIMgr.GetRootCanvas(), nil, "RectTransform").rect
    local canvasWidth = canvasRect.width
    local canvasHeight = canvasRect.height
    local canvasRatio = canvasWidth / canvasHeight

    local screenWidth = CS.UnityEngine.Screen.width
    local screenHeight = CS.UnityEngine.Screen.height
    local canvasScale = canvasWidth / screenWidth

    -- 如果在同一台设备上产生的照片，直接乘以屏幕到画布的缩放比例
    local destWidth = srcWidth * canvasScale
    local destHeight = srcHeight * canvasScale

    -- 如果是大头贴，直接返回大头贴比例
    if math.abs(srcWidth - PhotoEnum.StandardSize.Width) < 0.001 and math.abs(srcHeight - PhotoEnum.StandardSize.Heiht)  < 0.001 then
        destWidth = PhotoEnum.StandardSize.Width
        destHeight = PhotoEnum.StandardSize.Heiht
        return destWidth, destHeight
    end

    -- 如果照片尺寸大于设备分辨率
    if srcWidth > screenWidth or srcHeight > screenHeight then
        if canvasRatio > srcRatio then -- 照片比例“窄于”设备比例
            destWidth = canvasHeight / srcHeight * srcWidth
            destHeight = canvasHeight
        else -- 照片比例“宽于”设备比例
            destWidth = canvasWidth
            destHeight = canvasWidth / srcWidth * srcHeight
        end
        return destWidth, destHeight
    end

    return destWidth, destHeight
end

---将图片装到框内
function PhotoHelper.ResizePhotoWithLimit(limitX, limitY, photoRect)
    local limitScale = limitY / limitX
    local photoScale = photoRect.height / photoRect.width
    --图片的宽高比大于限制区域时
    if(photoScale > limitScale) then
        local scale =  photoRect.height / limitY
        return photoRect.width / scale, limitY
    else
        local scale = photoRect.width / limitX
        return limitX, photoRect.height / scale
    end
end

return PhotoHelper