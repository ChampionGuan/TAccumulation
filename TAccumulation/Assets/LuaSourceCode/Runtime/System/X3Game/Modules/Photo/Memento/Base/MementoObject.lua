---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by kan.
--- DateTime: 2022/2/10 11:31
--- 备忘录操作类
local Caretaker = require("Runtime.System.X3Game.Modules.Photo.Memento.Base.Caretaker")
local Originator = require("Runtime.System.X3Game.Modules.Photo.Memento.Base.Originator")
local MementoObject = class("MementoObject", nil, true)

function MementoObject:Init()
    self.caretaker = Caretaker:new()
    self.originator = Originator:new()
end

---新增备忘
function MementoObject:AddMemento(info)
    self.originator:SetInfo(info)
    local memento = self.originator:SaveInfoToMemento()
    self.caretaker:Add(memento)
end

---撤销
---@return Memento 操作对象
function MementoObject:UnDo()
    local curIndex = self.caretaker:GetIndex()
    if  curIndex == 0 then
        print("撤销操作失败！！！")
        return false,nil
    end

    print("撤销操作成功！！！")
    curIndex = curIndex - 1
    self.caretaker:SetIndex(curIndex)
    return true,self.caretaker:GetMemento(curIndex)
end

---重做
---@return Memento 操作对象
function MementoObject:ReDo()
    local curIndex = self.caretaker:GetIndex()
    local totalIndex = self.caretaker:GetMementoCount()
    if  curIndex == totalIndex then
        print("重做操作失败！！！")
        return nil
    end

    print("重做操作成功！！！")
    curIndex = curIndex + 1
    self.caretaker:SetIndex(curIndex)
    return self.caretaker:GetMemento(curIndex)
end

---重置
---@return bool 是否操作成功
function MementoObject:ReSet()
    local curIndex = self.caretaker:GetIndex()
    if curIndex == 0 then
        print("重置操作失败！！！")
        return false
    end

    print("重置操作成功！！！")
    self.caretaker:Reset()
    return true
end

return MementoObject
