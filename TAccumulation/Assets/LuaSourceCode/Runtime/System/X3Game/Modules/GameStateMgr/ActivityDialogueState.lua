---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jianxin.
--- DateTime: 2024/1/25 21:03
---
---@type MainHome.MainHomeConst
local MainHomeConst = require("Runtime.System.X3Game.Modules.MainHome.Data.MainHomeConst")
---@type BaseGameState
local BaseGameState = require("Runtime.System.X3Game.Modules.GameStateMgr.BaseGameState")
---@class ActivityDialogueState
local ActivityDialogueState = class("ActivityDialogueState", BaseGameState)

---@param enterCallback function
---@param isPre bool 是否是序章阶段
function ActivityDialogueState:OnEnter(stateName, enterCallback, exitCallback)
    self.exitCallback = exitCallback
    UIMgr.Open(UIConf.SpecialDatePlayWnd)
    self.virtualCamera = GlobalCameraMgr.CreateVirtualCamera(CameraModePath.AutoSyncMode)
    CutSceneMgr.SetCachePPVMode(true)
    if enterCallback then
        enterCallback()
    end
end

function ActivityDialogueState:ExitState()
    if self.exitCallback then
        self.exitCallback()
        self.exitCallback = nil
    end
    DialogueManager.ClearByName("ActivityDialogue")
    CutSceneMgr.SetCachePPVMode(false)
    CutSceneMgr.DestroyCachedPPV()
    if self.virtualCamera then
        GlobalCameraMgr.DestroyVirtualCamera(self.virtualCamera)
    end
    UIMgr.Close(UIConf.SpecialDatePlayWnd)
end

function ActivityDialogueState:OnExit()
    self:ExitState()
    self.super.OnExit(self)
end

return ActivityDialogueState