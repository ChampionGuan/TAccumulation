---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by pc.
--- DateTime: 2020/9/23 14:53
---


local CatCardConst = require("Runtime.System.X3Game.Modules.CatCard.Data.CatCardConst")
local BaseAni = require(CatCardConst.BASE_ANIMATION_PATH)
local RobShowCardAni = class("RobShowCardAni",BaseAni)

function RobShowCardAni:Execute(models,end_parents,speed,callback)
    if not models or #models == 0 then
        if callback then
            callback()
        end
        return
    end
    self:SetIsRunning(true)
    self.end_call = callback
    local end_parent
    local end_call = handler(self,self.OnFinish)
    self.running_count = 0
    local animation_st = CatCardConst.AnimationState.MOVE | CatCardConst.AnimationState.SCALE | CatCardConst.AnimationState.ROTATION
    for k,model in pairs(models) do
        end_parent = end_parents[k]
        self.running_count = self.running_count +1
        self.bll:CheckSound(CatCardConst.SoundType.DEFAULT,CatCardConst.Sound.SYSTEM_MIAO_CARDFLY)
        self.bll:CheckAnimation(CatCardConst.AnimationType.MOVE_MODEL,animation_st,model,end_parent,speed,end_call)
    end
end

function RobShowCardAni:OnFinish()
    self.running_count = self.running_count-1
    if self.running_count<=0 then
        self:SetIsRunning(false)
        local call = self.end_call
        self.end_call = nil
        if call then call() end
    end
end

return RobShowCardAni