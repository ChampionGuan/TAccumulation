---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xiaofang.
--- DateTime: 2022/6/8 14:25
---喵喵牌提示数据
------@type CatCardConst
local CatCardConst = require("Runtime.System.X3Game.Modules.CatCard.Data.CatCardConst")
---@type CatCard.BaseActionData
local BaseActionData = require(CatCardConst.BASE_ACTION_DATA_PATH)
-----@class CatCard.CatCardTipActionData:CatCard.BaseActionData
local CatCardTipActionData = class("CatCardTipActionData", BaseActionData)

function CatCardTipActionData:ctor()
    ---@type CatCardConst.TipsType
    self.tipType = nil
    self.slotIndex = 0 --槽位索引
    ---@type CatCardConst.CatCardTipData
    self.tipData = nil
    self.targetCardId = nil
end

---@param tipType CatCardConst.TipsType
---@param targetCardId int 目标功能拍（否决牌使用，其他可不传）
function CatCardTipActionData:Set(tipType, targetCardId)
    self.tipType = tipType
    self:SetTargetCardId(targetCardId)
    self:SetTipData()
end

---设置目标功能牌（否决牌使用）
function CatCardTipActionData:SetTargetCardId(cardId)
    self.targetCardId = cardId or 0
end

---@return int 目标功能牌id
function CatCardTipActionData:GetTargetCardId()
    return self.targetCardId
end

function CatCardTipActionData:SetTipData()
    self.tipData = CatCardConst.CatCardTipData[self.tipType]
end

---@return table CatCardConst.TipsType
function CatCardTipActionData:GetTipData()
    return self.tipData
end

---获得描述文本id
function CatCardTipActionData:GetDescID()
    if self.tipData.check_player_type then
        if self:GetPlayerType() == CatCardConst.PlayerType.PLAYER then
            return self.tipData.text_id
        else
            return self.tipData.npc_text_id
        end
    else
        return self.tipData.text_id
    end
end

---@param tipType CatCardConst.TipsType
function CatCardTipActionData:SetTipType(tipType)
    self.tipType = tipType
end

---@return int CatCardConst.TipsType
function CatCardTipActionData:GetTipType()
    if not self.tipType then
        local effectType = self:GetEffectType()
        if effectType then
            local param = self:GetParam()
            if effectType == CatCardConst.FuncEffectType.VetoQuery then
                self.tipType = CatCardConst.TipsType.VetoQuery
                self:SetTipData()
            elseif effectType == CatCardConst.FuncEffectType.Veto then
                self.tipType = CatCardConst.TipsType.VetoResult
            end
            self:SetTargetCardId(param[1])
        else
            local param = self:GetParam()
            if param and type(param) == "table" then
                self.tipType = param[1]
                self:SetTipData()
            end
        end
    end
    return self.tipType
end

---@param slotIndex :槽位索引
function CatCardTipActionData:SetSlotID(slotIndex)
    self.slotIndex = slotIndex
end

function CatCardTipActionData:GetSlotID()
    return self.slotIndex
end

return CatCardTipActionData