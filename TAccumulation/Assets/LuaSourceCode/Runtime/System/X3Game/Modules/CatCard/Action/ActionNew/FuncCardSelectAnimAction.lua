---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by hongyun.
--- DateTime: 2022/7/14 11:37
---

---@type CatCardConst
local CatCardConst = require("Runtime.System.X3Game.Modules.CatCard.Data.CatCardConst")

---@type CatCard.CatCardBaseAction
local BaseAction = require(CatCardConst.BASE_ACTION_PATH_NEW)

---播放女主功能牌选中动效的Action
---@class CatCard.FuncCardSelectAnimAction:CatCard.CatCardBaseAction
local FuncCardSelectAnimAction = class("FuncCardSelectAnimAction",BaseAction)

---@param action_data CatCard.FuncCardSelectAnimActionData
function FuncCardSelectAnimAction:Begin(action_data)

    local card_type = CatCardConst.CardType.CARD
    local index = action_data:GetPosIndex()
    local player_type = action_data:GetPlayerType()
    local speed = action_data:GetSpeed()
    local easy_type = action_data:GetEasyType()

    local card_data = self.bll:GetData(card_type,index,player_type)

    ---先隐藏手中的牌
    local card_logic = self:GetModel(card_type,index,player_type)
    card_logic:SetActive("",false)


    ---飞牌动效
    local slot_stack = self.logicCtrl:GetSlotStackNodeByType(CatCardConst.SubType.FUNCCARD,card_type,index,player_type)
    ---@type CatCard.ShowCardActionData
    local show_card_action_data = self.bll:GetActionData(CatCardConst.ActionType.ShowCardAction,player_type,function ()

        ---动效结束后显示被隐藏的手牌
        card_logic:SetActive("",true)

        ---@type CatCard.ShowCardActionData
        local hide_action_data = self.bll:GetActionData(CatCardConst.ActionType.ShowCardAction,player_type)
        hide_action_data:Set(card_data:GetId(),false,false,index)
        hide_action_data:Begin()

        self:End()

    end)

    show_card_action_data:Set(card_data:GetId(),true,true,index)
    show_card_action_data:SetSlotStack(slot_stack)
    show_card_action_data:SetMove(speed,easy_type)

    show_card_action_data:Begin()

    ---这里设置为true 才能在选中的功能牌动效播放期间可以点击其他功能牌
    self.bll:SetTouchEnable(true)

end



return FuncCardSelectAnimAction