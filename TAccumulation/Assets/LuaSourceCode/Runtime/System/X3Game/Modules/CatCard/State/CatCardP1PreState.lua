---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by pc.
--- DateTime: 2020/8/28 20:05
---

---@type CatCardConst
local CatCardConst = require("Runtime.System.X3Game.Modules.CatCard.Data.CatCardConst")
local BaseState = require(CatCardConst.BASE_STATE_PATH)
---@class CatCard.State.P1PreState:CatCardBaseState
local P1PreState = class("P1PreState", BaseState)

function P1PreState:Execute(is_special)
    if self.bll:IsPrepare() then
        self:ShowRealCards()
        return
    end
    self:SetIsRunning(true)
    self:ShowRealCards()
    if not is_special then
        --TODO CatCardDialogueModify
        self:CheckAction()
    else
        self:ChangeToSelect()
    end
end

function P1PreState:CheckAction()
    self:SetIsRunning(false)
    BaseState.CheckAction(self, CatCardConst.PlayerType.ENEMY)
end

function P1PreState:ChangeToSelect()
    self:SetIsRunning(false)
    local popState = self.bll:GetStateData():GetPopState()
    local state = ""
    if popState == CatCardConst.PopCardState.PopFuc then
        state = CatCardConst.DialogueState.PlayerSelectFuncCard
    else
        state = CatCardConst.DialogueState.PlayerSelect
    end
    local playerType = self.bll:GetPlayerType(self.bll.stateData:GetSeat())
    ---@type CatCard.ChangeDialogueStateActionData
    local actionData = self.bll:GetActionData(CatCardConst.ActionType.ChangeDialogueState, playerType)
    actionData:SetState(state)
    actionData:SetIsWait(false)
    actionData:SetDialogueCtrlState(CatCardConst.DialogueCtrlState.Start)
    actionData:Begin()
end

function P1PreState:GetCardsType()

end

return P1PreState