---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by sms.
--- DateTime: 2023/3/20 16:05
---

---@class SysThemeUtil
local SysThemeUtil = {}

local __getDefaultTheme, __getSysTheme, __setSysTheme
---------------------------------------------------------------------------------------------------------------------------------------------------
---Public方法定义
---@public 获得ThemeId
---@return number themeId
function SysThemeUtil.GetSysTheme()
    return __getSysTheme()
end

---@public 设置ThemeId
---@param themeId number themeId
function SysThemeUtil.SetSysTheme(themeId)
    __setSysTheme(themeId)

    PlayerPrefs.Save()
end

---@public 获取默认ThemeId
function SysThemeUtil.GetDefaultTheme()
    return __getDefaultTheme()
end
---------------------------------------------------------------------------------------------------------------------------------------------------
---私有方法定义

---@private 获取默认ThemeId
__getDefaultTheme = function()
    local defaultThemeId = LuaCfgMgr.Get("SundryConfig", X3_CFG_CONST.SYSTEMSETTINGPUSHINFODEFAULTID)
    
    -- 检查配置
    local defaultThemeCfg = LuaCfgMgr.Get("SystemPushInfo", defaultThemeId)
    if table.isnilorempty(defaultThemeCfg) then
        Debug.LogError("DefaultThemeCfg not found " .. table.dump({defaultThemeId})) 
        for _, cfg in pairs(LuaCfgMgr.GetAll("SystemPushInfo")) do
            if cfg.RoleType == 0 then return cfg.PushID end
        end
        return
    end
    
    return defaultThemeId
end

---@private 获取ThemeId
---@return number themeId
__getSysTheme = function()
    local themeId = PlayerPrefs.GetInt(ThemeEnum.SysThemeLocalKey.SysThemeResId)
    -- 如果本地缓存找不到, 以配置中默认值返回
    if themeId == 0 then return __getDefaultTheme() end
    return themeId
end

---@private 设置ThemeId
---@param themeId number themeId
__setSysTheme = function(themeId)
    themeId = themeId or __getDefaultTheme()

    PlayerPrefs.SetInt(ThemeEnum.SysThemeLocalKey.SysThemeResId, themeId)
end
---------------------------------------------------------------------------------------------------------------------------------------------------

return SysThemeUtil