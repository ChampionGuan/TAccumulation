---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by kan.
--- DateTime: 2022/1/26 11:46
---

local GachaHelper = {}
local DefaultTimeStamp = 0 --作为未配置时间处理

---时间是否过期
---@param timeStamp int 时间戳
---@param default bool 当未配置时间时默认返回值
function GachaHelper.TimeIsOver(timeStamp,default)
    if timeStamp == DefaultTimeStamp then return default end  --0作为未配置处理

    local currentTime = TimerMgr.GetCurTimeSeconds()
    return currentTime >= timeStamp
end

---通过字符串转换成时间戳
---@param strTime String 日期格式字符串 例如：20211202=05:00:00
function GachaHelper.GetTimeStampByStr(strTime)
    if string.isnilorempty(strTime) then return DefaultTimeStamp end

    return TimerMgr.GetUnixTimestamp(GameHelper.GetDateByStr(strTime))
end

---获取卡池结束时间戳
function GachaHelper.GetGachaOverTimeStamp(gachaInfo)
    local overTime = nil
    if not string.isnilorempty(gachaInfo.HideTime) then
        overTime = gachaInfo.HideTime
    elseif not string.isnilorempty(gachaInfo.CloseTime) then
        overTime = gachaInfo.CloseTime
    end

    return GachaHelper.GetTimeStampByStr(overTime)
end

---卡池是否过期
---@param gachaInfo GachaAll 卡池配置信息
function GachaHelper.GachaIsOver(gachaInfo)
    local overTimeStamp = GachaHelper.GetGachaOverTimeStamp(gachaInfo)
    return GachaHelper.TimeIsOver(overTimeStamp,false)
end

---检查group的开放是否满足条件检查
function GachaHelper.CheckGroupIsOpen(groupInfo)
    if groupInfo.OpenCondition == 0 then
        return true
    end

    return ConditionCheckUtil.CheckConditionByCommonConditionGroupId(groupInfo.OpenCondition)
end

---检查group的关闭是否满足条件检查
function GachaHelper.CheckGroupIsClose(groupInfo)
    if groupInfo.CloseCondition == 0 then
        return false
    end

    return ConditionCheckUtil.CheckConditionByCommonConditionGroupId(groupInfo.CloseCondition)
end

---检查Group是否显示
function GachaHelper.GroupIsShow(groupInfo)
    if groupInfo.ShowCondition == 0 then return true end --没有配置当开放处理
    return ConditionCheckUtil.CheckConditionByCommonConditionGroupId(groupInfo.ShowCondition)
end

return GachaHelper