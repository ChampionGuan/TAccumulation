---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by fusu.
--- DateTime: 2022/4/14 19:58
--- 陪伴Action
---@type AccompanyConst
local AccompanyConst = require("Runtime.System.X3Game.Modules.Accompany.Data.AccompanyConst")
---@type MainHome.MainHomeConst
local MainHomeConst = require("Runtime.System.X3Game.Modules.MainHome.Data.MainHomeConst")
---@type MainHome.BaseInteractAction
local BaseAction = require(MainHomeConst.BASE_INTERACT_ACTION)
---@class MainHome.AccompanyAction:MainHome.CountAction
local AccompanyAction = class("AccompanyAction", BaseAction)

function AccompanyAction:Enter()
    AccompanyAction.super.Enter(self)
    EventMgr.AddListener(MainHomeConst.Event.MAIN_HOME_ACCOMPANY_TRIGGER , self._OnAccompanyTrigger,  self)
    EventMgr.AddListener(MainHomeConst.Event.MAIN_HOME_ACCOMPANY_RECONNECT , self._OnAccompanyReconnect,  self)
end

function AccompanyAction:Begin()
    AccompanyAction.super.Begin(self)
    local actionData = self:GetActionData()
    BllMgr.GetAccompanyBLL():InitAccompany(actionData, false)
end

function AccompanyAction:End()
    AccompanyAction.super.End(self)
    BllMgr.GetAccompanyBLL():StopAccompany()
    UIMgr.Close(UIConf.AccompanySelectWnd)
end

---点击按钮进入陪伴
function AccompanyAction:_OnAccompanyTrigger()
    self.bll:StartAction(self:GetId())
end

---陪伴重连
function AccompanyAction:_OnAccompanyReconnect()
    local actionData = self:GetActionData()
    BllMgr.GetAccompanyBLL():InitAccompany(actionData, true)
end

return AccompanyAction