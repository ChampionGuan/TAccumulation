---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiaozhu.
--- DateTime: 2022/3/29 11:12
---相机跟随
---@type MainHome.MainHomeConst
local MainHomeConst = require("Runtime.System.X3Game.Modules.MainHome.Data.MainHomeConst")
---@type MainHome.BaseInteractAction
local BaseAction = require(MainHomeConst.BASE_INTERACT_ACTION)
---@class MainHome.CameraFollowAction:MainHome.BaseInteractAction
local CameraFollowAction = class("CameraFollowAction", BaseAction)

function CameraFollowAction:Begin()
    BaseAction.Begin(self)
    self:SetFollowCameraState(MainHomeConst.GyroState.Resume)
end

function CameraFollowAction:End()
    BaseAction.End(self)
    self:SetFollowCameraState(MainHomeConst.GyroState.Pause)
end

function CameraFollowAction:Enter()
    BaseAction.Enter(self)
    self:Trigger()
    self:SetFollowCameraState(MainHomeConst.GyroState.Resume)
    self:SetFollowCameraState(MainHomeConst.GyroState.Enable)
    self:SetFollowCameraState(MainHomeConst.GyroState.ForceRefresh)
end

function CameraFollowAction:Exit()
    BaseAction.Exit(self)
    self:End()
    self:SetFollowCameraState(MainHomeConst.GyroState.Disable)
end

---@param state MainHomeConst.GyroState
function CameraFollowAction:SetFollowCameraState(state)
    EventMgr.Dispatch(MainHomeConst.Event.MAIN_HOME_SET_FOLLOW_CAMERA_STATE,state)
end

function CameraFollowAction:OnEventSetActionRunning(actionId,isRunning)
    if actionId~=self:GetId() and not isRunning and  not self:IsRunning() then
        self:Trigger()
    end
end

function CameraFollowAction:OnAddListener()
    EventMgr.AddListener(MainHomeConst.Event.MAIN_HOME_SET_ACTION_SHOW_RUNNING,self.OnEventSetActionRunning,self)
end

return CameraFollowAction