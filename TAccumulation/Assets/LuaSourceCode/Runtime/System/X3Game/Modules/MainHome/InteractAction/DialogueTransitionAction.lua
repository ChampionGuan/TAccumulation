---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by fusu.
--- DateTime: 2023/7/19 19:02
---
---@type MainHome.MainHomeConst
local MainHomeConst = require("Runtime.System.X3Game.Modules.MainHome.Data.MainHomeConst")
---@type MainHome.BaseInteractAction
local BaseAction = require(MainHomeConst.BASE_INTERACT_ACTION)
---@class MainHome.DialogueTransitionAction:MainHome.BaseInteractAction
local DialogueTransitionAction = class("DialogueTransitionAction", BaseAction)

function DialogueTransitionAction:Enter()
    BaseAction.Enter(self)
    self.transitionCallBack = nil
end

function DialogueTransitionAction:Begin(callBack)
    BaseAction.Begin(self)
    local stateSwitchConf = self.bll:GetData():GetStateSwitchConf()
    if not stateSwitchConf then
        self:DoCallBack()
        return
    end
    self.transitionCallBack = self:GetActionParam()
    local dialogueId = stateSwitchConf.DialogueID
    local dialogueName = stateSwitchConf.ConversationName
    self:PlayDialogue(dialogueId , dialogueName)
end

function DialogueTransitionAction:OnDialogueEnd(dialogueId, conversion, pipelineKey)
    BaseAction.OnDialogueEnd(self,dialogueId, conversion, pipelineKey)
    self:DoCallBack()
end

function DialogueTransitionAction:Exit()
    BaseAction.Exit(self)
    self:DoCallBack()
end

function DialogueTransitionAction:DoCallBack()
    if self.transitionCallBack then
        self.transitionCallBack()
        self.transitionCallBack = nil
    end
end


return DialogueTransitionAction