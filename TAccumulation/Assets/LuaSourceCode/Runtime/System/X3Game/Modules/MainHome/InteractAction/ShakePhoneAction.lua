---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiaozhu.
--- DateTime: 2022/3/28 18:00
--- 手机摇晃
---@type MainHome.MainHomeConst
local MainHomeConst = require("Runtime.System.X3Game.Modules.MainHome.Data.MainHomeConst")
---@type MainHome.CountAction
local BaseAction = require("Runtime.System.X3Game.Modules.MainHome.InteractAction.CountAction")
---@class MainHome.ShakePhoneAction:MainHome.CountAction
local ShakePhoneAction = class("ShakePhoneAction", BaseAction)

function ShakePhoneAction:Enter()
    BaseAction.Enter(self)
    self:CheckMaxCount()
end

function ShakePhoneAction:Begin()
    BaseAction.Begin(self)
    self:PlayDialogue()
end

---摇晃手机成功
function ShakePhoneAction:OnShake()
    self:SaveCount()
    local data = self:GetActionData()
    local count = self:GetCount(data.Para1)
    if count>=data.Para2 then
        self:Reset()
        self:Trigger()
    end
end

function ShakePhoneAction:OnAddListener()
    EventMgr.AddListener(MainHomeConst.Event.MAIN_HOME_SHAKE_PHONE,self.OnShake,self)
end

function ShakePhoneAction:CheckMaxCount()
    local data = self:GetActionData()
    if data then
        self:SetMaxCount(data.Para2)
    end
end

return ShakePhoneAction