--- Generated by AutoGen
---
---
local AccompanyConst = require("Runtime.System.X3Game.Modules.Accompany.Data.AccompanyConst")
---@class MsgCmd_StartAccompanyReply
local MsgCmd_StartAccompanyReply = class("MsgCmd_StartAccompanyReply", require("Runtime.System.Framework.GameBase.Misc.SimpleCommand"))

---Command执行
---@param reply pbcmessage.StartAccompanyReply
function MsgCmd_StartAccompanyReply:Execute(reply)
    ---Insert Your Code Here!
    Debug.LogFormat("MsgCmd_StartAccompanyReply StartTime: %s" ,reply.StartTime)
    local bll = BllMgr.GetAccompanyBLL()
    local roleId = bll:GetCurRoleId()
    local accompanyType = bll:GetCurAccompanyType()
    local accompanyTime = bll:GetAccompanyTime() *  60 *  1000
    local expectTime = SelfProxyFactory.GetAccompanyProxy():GetExpectTime(roleId)
    SelfProxyFactory.GetAccompanyProxy():AddOrUpdateRoleData(roleId , 
    { 
                RoleID = roleId , 
                Type = accompanyType , 
                StartTime = reply.StartTime,
                ---这里续钟的时间需要累加
                ExpectDuration = accompanyTime + expectTime * 1000,
                WaitDuration = reply.WaitDuration,
    })
    EventMgr.Dispatch(AccompanyConst.Event.ON_START_ACCOMPANY_REPLY)
    
end

return MsgCmd_StartAccompanyReply
