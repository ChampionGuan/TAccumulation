--- Generated by AutoGen
---
---@class MsgCmd_FriendStaminaRecvReply
local MsgCmd_FriendStaminaRecvReply = class("MsgCmd_FriendStaminaRecvReply", require("Runtime.System.Framework.GameBase.Misc.SimpleCommand"))

---Command执行
---@param reply pbcmessage.FriendStaminaRecvReply
function MsgCmd_FriendStaminaRecvReply:Execute(reply)
    if reply then
        ---@type FriendProxy
        local proxy = SelfProxyFactory.GetFriendProxy()
        local friendStaminaRecvList = reply.FriendStaminaRecvList
        if friendStaminaRecvList and #friendStaminaRecvList > 0 then
            local isBatchOp = BllMgr.GetFriendBLL():GetIsRecvBatch()
            local powerNum = 0
            local rewardList = {}
            for _, uid in ipairs(friendStaminaRecvList) do
                powerNum = powerNum + BllMgr.GetFriendBLL():GetConfig_FriendedGiftDrawNum()
                proxy:SetStaminaDrawn(uid)
                proxy:RefreshFriendedItemByUid(uid)
            end
            if powerNum > 0 then
                local reward = { Id =  3, Type = 1, Num = powerNum }
                table.insert(rewardList, reward)
            end

            UICommonUtil.ShowRewardPopTips(rewardList, 1, isBatchOp)
            ---更新好友数据列表和按钮状态
            EventMgr.Dispatch("EVENT_REFRESH_FRIENDED_SCROLLVIEW")
            BllMgr.GetFriendBLL():CheckRed(false, true)
        else
            Debug.Log("RecvMsg_FriendStaminaRecvReply error, serverdata.FriendStaminaRecvList = nilOrEmpty")
        end
    else
        Debug.Log("RecvMsg_FriendStaminaRecvReply error, serverdata = nil")
    end
end

return MsgCmd_FriendStaminaRecvReply
