---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by sms.
--- DateTime: 2023/6/12 17:36

---@class DungeonRecordProxy 目前用来维护战斗结果相关的数据结构
local DungeonRecordProxy = class("DungeonRecordProxy", BaseProxy)

function DungeonRecordProxy:OnInit()
    ---@type table<number, pbcmessage.DungeonRecord> 最近一次战斗记录的Map<roleId 男主id, 战斗记录>
    self.currentDungeonRecordMap = {}
end

function DungeonRecordProxy:OnClear()
    self.currentDungeonRecordMap = {}
end

-- 更新男主对应的战斗记录
---@param roleId number 男主id
---@param dungeonRecord pbcmessage.DungeonRecord 战斗记录
function DungeonRecordProxy:UpdateDungeonRecord(roleId, dungeonRecord)
    if not roleId or table.isnilorempty(dungeonRecord) then
        Debug.LogError("roleId or dungeonRecord not found, " .. table.dump({roleId, dungeonRecord}))
    end

    self.currentDungeonRecordMap[roleId] = dungeonRecord
end

-- 获取男主对应的战斗记录
---@param roleId number 男主id
function DungeonRecordProxy:GetDungeonRecord(roleId)
    if not roleId or roleId <= 0 then return self:GetAllDungeonRecord() end
    
    return self.currentDungeonRecordMap[roleId] or {}
end

-- 获取所有战斗记录
function DungeonRecordProxy:GetAllDungeonRecord()
    return self.currentDungeonRecordMap
end

return DungeonRecordProxy