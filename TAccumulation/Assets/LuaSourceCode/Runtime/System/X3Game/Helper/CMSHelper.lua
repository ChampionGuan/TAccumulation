---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xiangyu.
--- DateTime: 2023/2/17 20:45
---
---和CMS相关的
---@class CMSHelper
local CMSHelper = {}

---通过jsonData和索引过滤有效数据
---@param index string CMS上各字段索引不一样，有空再BATTLE
function CMSHelper.GetValueByLang(jsonData, index)
    local lang = Locale.GetCMSLangName()
    local fallbackLang = Locale.GetCMSFallbackLangName()
    local fallbackV = ""
    local v = ""
    if(jsonData) then
        for i = 1, #jsonData do
            if(lang == jsonData[i].lang) then
                v = jsonData[i][index]
                break;
            end
            if(fallbackLang == jsonData[i].lang) then
                fallbackV = jsonData[i][index]
            end
        end
    end
    return (not string.isnilorempty(v)) and v or fallbackV
end

---将cms配置的国服时间转化成服务器时间戳
---@param timeStr string CMS配置的时间("2021-07-01T17:00:00+08:00")
---@return number
function CMSHelper.GetConvertServerStamp(timeStr)
    local stamp = GameHelper.GetTimeStamp(timeStr)
    local result = stamp + TimerMgr.GetZoneDiff() - 8 * 3600--(注意：CMS上的配置，均为国服时间）
    return result
end

return CMSHelper