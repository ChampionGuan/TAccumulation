---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by changkong.
--- DateTime: 2022/4/18 21:14
---
if not Debug.IsDebugBuild() then
    return  -- 只有debug包需要注入
end

local classFunc2Name = {}

local GetProfileName = function(class, funcName)
    local func2Name = classFunc2Name[class]
    if not func2Name then
        func2Name = {}
        classFunc2Name[class] = func2Name
    end
    local profileName = func2Name[funcName]
    if not profileName then
        profileName = string.format("%s %s", class.__cname or "未识别", funcName)
        func2Name[funcName] = profileName
    end
    return profileName
end

local ProfileInject = function(classParam)
    if not classParam then
        return
    end
    local curClass = classParam
    for k, v in pairs(curClass) do
        if type(v) == "function" then
            if k ~= "New" and k ~= "new" then
                GetProfileName(curClass, k)
                curClass[k] = function(...)
                    local name = GetProfileName(curClass, k)
                    Profiler.BeginSample(name)
                    local r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12, r13, r14, r15 = v(...)
                    Profiler.EndSample(name)
                    return r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12, r13, r14, r15
                end
            end
        end
    end
end

ProfileInject(require("Runtime.Battle.View.Actor.ViewRole"))
ProfileInject(require("Runtime.Battle.View.Actor.ViewActor"))
ProfileInject(require("Runtime.Battle.View.Behavior.BattleLogic"))
ProfileInject(require("Runtime.Battle.View.Behavior.FloatWordsMgr"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Context.BattleTimelineContext"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Context.DefaultTimelineContext"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Feature.BattlePerformFeature"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Feature.BattlePerformEventFeature"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Feature.BattleResFeature"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Feature.MaterialAnimFeature"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Feature.TrackBindFeature"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.Timeline"))
ProfileInject(require("Runtime.System.X3Game.Modules.Timeline.TimelineMgr"))