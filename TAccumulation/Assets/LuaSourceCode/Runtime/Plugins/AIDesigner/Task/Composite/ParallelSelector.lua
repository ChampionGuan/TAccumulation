---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by chaoguan.
--- DateTime: 2020/11/26 16:58
---

local AIComposite = require("Runtime.Plugins.AIDesigner.Base.AITask").AIComposite

---与Selector类似，只要一个子节点返回成功，此节点就会返回成功。 
---不同的是，此节点将同时运行其所有的子节点，而不是一次运行每个节点。 
---如果一个子节点返回成功，此节点并返回成功。如果所有子节点都返回失败，那么此节点将返回失败。
---IconName:ParallelSelectorIcon.png
---@class AI.ParallelSelector:AIComposite
local ParallelSelector = AIUtil.class("ParallelSelector", AIComposite)

---阻塞类型
ParallelSelector.blockingUpType = AIBlockingUpType.ParallelSelector

function ParallelSelector:OnUpdate()
    local isBlockingUp = false
    for _, child in ipairs(self.children) do
        if not child.disabled then
            if child.state == AITaskState.Success then
                return AITaskState.Success
            elseif child.state == AITaskState.Running or child.state == AITaskState.BlockingUp then
                isBlockingUp = true
            end
        end
    end
    return isBlockingUp and AITaskState.Running or AITaskState.Failure
end

return ParallelSelector