---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by chaoguan.
--- DateTime: 2020/11/26 19:13
---

local AIDecorator = require("Runtime.Plugins.AIDesigner.Base.AITask").AIDecorator

---重复执行子节点；
---当Count值小于0时，表示永久重复执行
---IconName:RepeaterIcon.png
---@class AI.Repeater:AIDecorator
---@field count AIVar|Int
local Repeater = AIUtil.class("Repeater", AIDecorator)

---阻塞类型
Repeater.blockingUpType = AIBlockingUpType.Repeater

function Repeater:OnEnter()
    self._leftCount = self.count:GetValue()
    self._forever = self._leftCount < 0
end

function Repeater:LeftRepetitions()
    if self._forever then
        return 1
    end

    local result = self._leftCount
    self._leftCount = result - 1
    return result
end

function Repeater:CanRunChild()
    return self._leftCount ~= 0
end

return Repeater