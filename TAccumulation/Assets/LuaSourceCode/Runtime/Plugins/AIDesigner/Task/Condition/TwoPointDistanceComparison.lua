---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by chaoguan.
--- DateTime: 2020/12/14 15:32
---

local AICondition = require("Runtime.Plugins.AIDesigner.Base.AITask").AICondition

---两点之间距离比较
---@class SystemAI.TwoPointDistanceComparison:AICondition
---@field operation ComparisonOperation|Int
---@field distance AIVar|Float
---@field point1 AIVar|Vector3
---@field point2 AIVar|Vector3
local TwoPointDistanceComparison = AIUtil.class("TwoPointDistanceComparison", AICondition)

function TwoPointDistanceComparison:OnUpdate()
    local sqrDistanceF = (self.point1:GetValue() - self.point2:GetValue()):SqrMagnitude()
    local sqrDistanceT = self.distance:GetValue() * self.distance:GetValue()

    if self.operation == ComparisonOperation.LessThan then
        return sqrDistanceF < sqrDistanceT and AITaskState.Success or AITaskState.Failure
    elseif self.operation == ComparisonOperation.LessThanOrEqualTo then
        return sqrDistanceF <= sqrDistanceT and AITaskState.Success or AITaskState.Failure
    elseif self.operation == ComparisonOperation.EqualTo then
        return sqrDistanceF == sqrDistanceT and AITaskState.Success or AITaskState.Failure
    elseif self.operation == ComparisonOperation.NotEqualTo then
        return sqrDistanceF ~= sqrDistanceT and AITaskState.Success or AITaskState.Failure
    elseif self.operation == ComparisonOperation.GreaterThanOrEqualTo then
        return sqrDistanceF >= sqrDistanceT and AITaskState.Success or AITaskState.Failure
    elseif self.operation == ComparisonOperation.GreaterThan then
        return sqrDistanceF > sqrDistanceT and AITaskState.Success or AITaskState.Failure
    end
    return AITaskState.Failure
end

return TwoPointDistanceComparison